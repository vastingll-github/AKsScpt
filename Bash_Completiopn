＊ポイント*
・COMPREPLY の動き compgen -W が動かない時がある
　これは調べたところ、選択肢リストにない$curが設定されると、表示をしないことがわかった。
・オプションがデフォルトスペース区切なので、スペースのある選択肢を羅列するのに工夫がいる
  IFS=","  IFS=' \n\t'
        ( ダブルクォートとシングルクォートの違いがシェルスクリプト特有 )
・TABで 、定義した関数がその度にコールされるが、シェル変数(cur, COMPREPLY, prev, cword)
  の内容が制御する場合の判断式の書き方が様々あるので気をつけなければならない



*Bash_Completion とは*
１．シェル関数でコマンド補完を行うもので、TAB押下で関数コール。
２．【 complete 】コマンド  補完方法の指定（bash）
https://atmarkit.itmedia.co.jp/ait/articles/1907/12/news015.html#sample8
３．【 compgen 】コマンド   bashの補完候補を生成する／使用できるコマンド名を一覧表示する
https://atmarkit.itmedia.co.jp/ait/articles/1907/18/news009.html
４．補完関連情報は以下に全て格納される。
　　/usr/share/bash_completion/
    ~/.bash_completion


* bash_completionのコマンド仕様:

(1) compgen [option] [word]

・ オプションに従って word の補完候補を生成し、その候補を標準出力に書き込む。
・ オプションは、-p と -r を除く、complete 組み込みコマンド同じであるオプションです。
pcp@app-pcp1:~$ cat /opt/nfs/fshare/Learn/bash-completion.rep
＊ポイント
・COMPREPLY の動き compgen -W が動かない時がある
　これは調べたところ、選択肢リストにない$curが設定されると、表示をしないことがわかった。
・オプションがデフォルトスペース区切なので、スペースのある選択肢を羅列するのに工夫がいる
  IFS=","  IFS=' \n\t'
        ( ダブルクォートとシングルクォートの違いがシェルスクリプト特有 )
・TABで 、定義した関数がその度にコールされるが、シェル変数(cur, COMPREPLY, prev, cword)
  の内容が制御する場合の判断式の書き方が様々あるので気をつけなければならない



* Bash_Completion とは
１．シェル関数でコマンド補完を行うもので、TAB押下で関数コール。
２．【 complete 】コマンド  補完方法の指定（bash）
https://atmarkit.itmedia.co.jp/ait/articles/1907/12/news015.html#sample8
３．【 compgen 】コマンド   bashの補完候補を生成する／使用できるコマンド名を一覧表示する
https://atmarkit.itmedia.co.jp/ait/articles/1907/18/news009.html
４．補完関連情報は以下に全て格納される。
　　/usr/share/bash_completion/
    ~/.bash_completion


*コマンド仕様:*
(1) compgen [option] [word]
<pre>
・ オプションに従って word の補完候補を生成し、その候補を標準出力に書き込む。
・ オプションは、-p と -r を除く、complete 組み込みコマンド同じであるオプションです。
・ -F または -C オプションは、Fは人手間かかり（COMPREPLY に設定後),C はシステムのコマンド補完によって
  設定される。シェル変数は、 使用可能だが有効な値を持たない。
・ 候補は、プログラム可能な補完コードが同じフラグを使用して補完仕様から直接生成した場合と同じ方法で生成される。
・ word(Script Value $cur ) がある場合は、word に一致する補完のみが表示。
・ 無効なwordが指定された場合、または候補が生成されなかった場合を除いて、戻り値は true です。
・ COMPREPLY は補完可能な配列変数を格納。
☆ compgenコマンドに指定する、'--' の文字列は補完対象の終端を示す文字列。

compgen
compgenは、オプションによって出てくる補完候補から、引数とマッチ（基本的に前方一致）するものだけを絞り込むコマンド。
各オプションはman 7 bash-builtinsに詳しく記述。ここでは主要なオプションだけ紹介。

-W
-Wは、変換候補となる文字列のリストを指定するオプションです。以下のように、指定した文字列リストから、引数と前方一致する
ものだけに絞り込んでリストアップしてくれます。

$ compgen -W "one two once twice" --
one
two
once
twice
$ compgen -W "one two once twice" -- o
one
once
$ compgen -W "one two once twice" -- onc once -c/-f/-d
自前で文字列のリストを与えなくても、コマンドのリストとか、ファイルのリストとかを補完候補にすることができるオプションです。-cはコマンド（と実行ファイル、ディレクトリ）、-fはファイル、-dはディレクトリを補完するようになります。たとえば、以下のように-cオプションにmanという引数を与えると、manから始まるコマンドがリストアップされます。

$ compgen -c -- man
mandb
manpage-alert
man
manpath
補完してみる
compgenを使うと、dummy()は現在のコマンドラインの文字を使って候補を絞り込んだ補完ができるようになります。
</pre>



・TAB補完
 ・デフォルトであらゆる状況に対して適切な補完が効くわけではない。
 ・文脈に応じて補完候補を独自でカスタマイズしたいという状況が生じる
 ・この場合，bash にある programmable completion を使うことでカスタマイズ可能 (好きな補完候補を表示)

・補完のしくみ
bash では補完を行う際，事前に設定されたシェルスクリプト関数を呼び出す．
このシェルスクリプト関数はコマンド名や入力中の引数を受取り解析し，文脈に応じて適切な補完候補を生成する
bash-completionパッケージで利用可能

GitHub - scop/bash-completion: Programmable completion functions for bash

/usr/share/bash-completionなどに補完用の関数の定義がある(~/.bashrc内にこれらのファイルを読込む設定があるはず)．

現在導入済みであれば、complete -p で確認可能

complete -F _longopt mv
complete -F _root_command gksudo
complete -F _command nice
complete -F _longopt tr
complete -F _longopt head
...

この出力は bash で実行できるような形で出力されており，
 complete -F <function-name> <command-name>
で <command-name>というコマンド引数の補完方法に<function-name>というシェルスクリプト関数を指定する．


bash-completionはかなり便利だがそれでもパターンが網羅されているわけではない．
自分で補完候補を定義したい場合は，自分でシェルスクリプト関数を書いて補完用の関数として指定すれば良い．

自作の補完関数は，~/.bash_completionに保存しておけばbash-completionが勝手に読み込む．


■タブを押すと、_xxx()にCOMP_CWORDとかCOMP_WORDSといった変数で今のコマンドラインに入力されている
文字が渡される。_xxx()はそこから候補を絞込結果を、COMPREPLYという変数で返す。それがタブ補完の候補表示となる。

COMP_CWORD : 今カーソルがあるワードは何語目か表す
COMP_WORDS : コマンドラインのワードのリスト
例）
$ _dummy()
{
  echo
  echo COMP_CWORD: ${COMP_CWORD}
  echo COMP_WORDS: ${COMP_WORDS[@]}
}
$ man <TAB>
COMP_CWORD: 1
COMP_WORDS: man
$ man test test2<TAB>
COMP_CWORD: 2
COMP_WORDS: man test test2
$ man test test2 <TAB>
COMP_CWORD: 3
COMP_WORDS: man test test2




【補完候補絞込組込み関数】
入力途中の文字列にマッチする候補に絞込む compgen 組込関数．
オプションにより word の補完候補を生成し、その候補を標準出力に書き込む。オプションは、-p と -r を除き、
complete 組込みコマンドで受け入れられる任意のオプションです。
-F または -C オプションを使用すると、プログラム可能な補完機能によって設定されるさまざまなシェル変数は、
使用可能ではあるものの、有用な値を持ちません。

comgen <option> <word>


ユーザがタブを押すと、_xxx()にCOMP_CWORDとかCOMP_WORDSといった変数で今のコマンドラインに入力されている


【定義済関数】
・入力引数取得

このために入力中の引数の数や引数の中身を取得するための
_get_comp_words_by_ref
という関数がbash-completionで用意している． これを使うには，次のように書けばよい．

local cur prev cword
_get_comp_words_by_ref -n : cur prev cword


localというのは関数のローカル変数を定義するための bash のキーワード．
_get_comp_words_by_ref -n : cur prev cword
という書き方で，それぞれ
cur: 現在入力中の引数
prev: ひとつ前の引数
cword: 引数の数
が設定される．

例えば，次のように補完を定義する．

_dummy() {
    local cur prev cword
    _get_comp_words_by_ref -n : cur prev cword
    echo
    echo cur: ${cur}
    echo prev: ${prev}
    echo cword: ${cword}
}
complete -F _dummy dummy

・補完候補の絞り込み
入力途中の文字列にマッチする候補だけに絞りこむには compgen という組み込み関数が使える．

comgen <option> <word>
という形で，オプションで指定した方法で生成された補完候補のうち先頭がwordにマッチするもののリストを生成する．

例えば，-W <word list>という空白区切りの文字列を補完候補とするようなオプションを使って，

compgen -W "foo bar baz" ba

と実行すると，foo,bar,bazのうちbaから始まるbarとbazが補完候補として生成される．

典型的には，COMPREPLYの値にcompgenで生成したリストを設定することで候補の絞り込みを実現する．
オプションが-logfileや-fのときにはファイルへのパスが補完されます。
compopt -o filenamesは、ディレクトリ名には/を付ける

・_fileedir '@(xx|tt|zz)' でリストのファイル名だけ探すようだ



Programmable Completion

プログラム可能な補完
complete 組み込みコマンドを使用して補完仕様 (補完仕様) が定義されているコマンドの引数に対して単語補完が試行されると
(以下のシェル組み込みコマンドを参照)、プログラム可能な補完機能が呼び出されます。

まず、コマンド名が識別されます。コマンド ワードが空文字列の場合 (空行の先頭で補完が試行された場合)、complete の -E
オプションで定義されている補完仕様が使用されます。そのコマンドに対して補完仕様が定義されている場合、その補完仕様を使用して、そのワードの可能な補完のリストが生成されます。コマンド
ワードがフル パス名の場合、最初にフル パス名の補完仕様が検索されます。フル
パス名の補完仕様が見つからない場合、最後のスラッシュに続く部分の補完仕様が検索されます。これらの検索で補完仕様が見つからない場合、complete
の -D オプションで定義されている補完仕様がデフォルトとして使用されます。デフォルトの補完仕様がない場合、bash
は最後の手段としてコマンド ワードのエイリアス展開を試み、成功した展開からコマンド ワードの補完仕様を見つけようとします。

補完仕様が見つかると、それを使用して一致する単語のリストが生成されます。補完仕様が見つからない場合は、上記の補完で説明したデフォルトの
bash 補完が実行されます。

まず、補完仕様で指定されたアクションが使用されます。補完される単語が先頭に付いている一致のみが返されます。ファイル名またはディレクトリ名の補完に
-f または -d オプションが使用される場合、シェル変数 FIGNORE を使用して一致がフィルタリングされます。

次に、-G オプションのパス名展開パターンで指定された補完が生成されます。パターンによって生成された単語は、補完される単語と一致する必要はありません。GLOBIGNORE
シェル変数は一致のフィルタリングには使用されませんが、FIGNORE 変数が使用されます。

次に、-W オプションの引数として指定された文字列が考慮されます。文字列は、まず IFS
特殊変数の文字を区切り文字として使用して分割されます。シェルの引用符が尊重されます。次に、各単語は、前述の「展開」で説明したように、中括弧展開、チルダ展開、パラメータと変数の展開、コマンド置換、算術展開を使用して展開されます。結果は、前述の「単語の分割」で説明した規則を使用して分割されます。展開の結果は、補完される単語に対してプレフィックス
マッチングされ、一致する単語が補完候補になります。

これらの一致が生成された後、-F および -C
オプションで指定されたシェル関数またはコマンドが呼び出されます。コマンドまたは関数が呼び出されると、前述の「シェル変数」で説明したように、COMP_LINE、COMP_POINT、COMP_KEY、および
COMP_TYPE 変数に値が割り当てられます。シェル関数が呼び出される場合は、COMP_WORDS および COMP_CWORD
変数も設定されます。関数またはコマンドが呼び出されると、最初の引数 ($1) は引数が補完されるコマンドの名前、2 番目の引数 ($2)
は補完される単語、3 番目の引数 ($3) は現在のコマンド
ラインで補完される単語の前の単語です。生成された補完は補完される単語に対してフィルタリングされません。関数またはコマンドは、一致を生成する際に完全に自由に選択できます。

-F で指定された関数は最初に呼び出されます。関数は、以下で説明する compgen
組み込み関数を含むシェル機能のいずれかを使用して、一致を生成できます。候補となる補完を COMPREPLY 配列変数に、配列要素ごとに 1
つずつ入れる必要があります。

次に、-C オプションで指定されたコマンドが、コマンド置換と同等の環境で呼び出されます。候補のリストを 1 行に 1
つずつ標準出力に出力する必要があります。必要に応じて、改行をエスケープするためにバックスラッシュを使用できます。

候補となる補完がすべて生成された後、-X
オプションで指定されたフィルターがリストに適用されます。フィルタはパス名展開に使用されるパターンです。パターン内の &
は補完される単語のテキストに置き換えられます。リテラルの &
はバックスラッシュでエスケープできます。バックスラッシュは一致を試みる前に削除されます。パターンに一致する補完はリストから削除されます。先頭の
! はパターンを否定します。この場合、パターンに一致しない補完は削除されます。nocasematch シェル
オプションが有効になっている場合、アルファベットの大文字と小文字に関係なく一致が実行されます。

【参考情報：翻訳ノウハウ】
◆https://support.google.com/translate/answer/2534559?hl=ja&co=GENIE.Platform%3DDesktop
Google翻訳のファイル指定の説明

ドキュメントやウェブサイトを翻訳する
一部のデバイスでウェブサイトやドキュメントを翻訳できます。

ドキュメント翻訳種類 .docxで実証済
.docx、
.pdf、
.pptx、
.xlsx
の形式のドキュメントを最大 10 MB まで翻訳。
PDF ファイルは 300 ページ以下。
より多くのドキュメントまたはより大きなドキュメントを翻訳するには、Cloud Translation API の詳細をご覧ください。

重要: ドキュメントの翻訳は、現時点では小さい画面とモバイルではサポートされていません。
ブラウザで Google 翻訳にアクセスします。
上部の [ドキュメント] をクリックします。
翻訳元の言語と翻訳先の言語を選択します。
ウェブサイトの元の言語を自動的に設定するには、[言語を検出する] をクリックします。
[パソコンを参照] をクリックします。
翻訳するファイルを選択します。
[翻訳を表示] または [翻訳をダウンロード] をクリックします。
どちらが表示されるかは、ドキュメントの形式によって異なります。
